{% extends 'AppBundle::base.html.twig' %}

{% block stylesheets %}
    {% stylesheets output="assets/home/default/index/css/local.css"
    '@BckHomeBundle/Resources/public/default/index/scss/dist/styles.css'
    '@fullcalendar_css'
    %}
    <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}
{% endblock %}

{% block head_javascripts %}
    {{ parent() }}

    {% set userCalendarData = render(controller(
    'BckUserBundle:UserCalendar:dataForHome',
    {'responseType': 'json'}
    )) %}

    {% set userBookingData = render(controller(
    'BckBookingBundle:Booking:dataForHome',
    {'responseType': 'json'}
    )) %}

    {% set clientData = render(controller(
    'BckEntitiesBundle:Client:dataForHome',
    {'responseType': 'json'}
    )) %}

    {% set clientDocumentData = render(controller(
    'BckAccountingBundle:ClientDocument:dataForHome',
    {'responseType': 'json'}
    )) %}

    {% set supplierDocumentData = render(controller(
    'BckAccountingBundle:SupplierDocument:dataForHome',
    {'responseType': 'json'}
    )) %}

    <script>
        _app.dependencies.userCalendar = {{ userCalendarData|raw }};
        _app.dependencies.userBooking = {{ userBookingData|raw }};
        _app.dependencies.client = {{ clientData|raw }};
        _app.dependencies.clientDocument = {{ clientDocumentData|raw }};
        _app.dependencies.supplierDocument = {{ supplierDocumentData|raw }};
    </script>
{% endblock %}

{% block header_container %}
    <div class="row align-items-center">
        <div class="col-auto">
            <div class="d-inline-block my-3 ml-3"><img alt="Avatar" class="img-circle" src="{{app.session.get('_app.user')['avatar']}}" width="48" height="48"/></div>
        </div>
        <div class="col">
            <h2 class="d-inline-block">Welcome {{ app.session.get('_app.user')['name'] }}</h2>
        </div>
    </div>
{% endblock %}

{% block vendor_javascripts %}
    {{ parent() }}

    {% javascripts output="assets/home/default/index/js/vendor.js"
    '@moment_js'
    '@fullcalendar_js'
    %}
    <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}

{% block javascripts %}
    {% javascripts output="assets/home/default/index/js/local.js"
    '@BckHomeBundle/Resources/public/default/index/ts/dist/inline.bundle.js'
    '@BckHomeBundle/Resources/public/default/index/ts/dist/polyfills.bundle.js'
    '@BckHomeBundle/Resources/public/default/index/ts/dist/vendor.bundle.js'
    '@BckHomeBundle/Resources/public/default/index/ts/dist/main.bundle.js'
    %}
    <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}